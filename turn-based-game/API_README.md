# üéÆ Turn-Based Game API Documentation

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∏–≥—Ä–æ–≤—ã–º API endpoints –¥–ª—è –ø–æ—à–∞–≥–æ–≤–æ–π –∏–≥—Ä—ã —Å –∞–≥–µ–Ω—Ç–∞–º–∏, –∫–Ω–æ–ø–∫–∞–º–∏ –∏ –º–æ—Å—Ç–∞–º–∏.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–î–≤–∏–∂–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞](#–¥–≤–∏–∂–µ–Ω–∏–µ-–ø–µ—Ä—Å–æ–Ω–∞–∂–∞)
- [–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–æ–≤](#–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ-–∞–≥–µ–Ω—Ç–æ–≤) 
- [–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–Ω–æ–ø–æ–∫](#–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-–∫–Ω–æ–ø–æ–∫)
- [–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞](#–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-–∫–æ–º–ø—å—é—Ç–µ—Ä–∞)
- [–°–±—Ä–æ—Å –ø–æ–∑–∏—Ü–∏–∏](#—Å–±—Ä–æ—Å-–ø–æ–∑–∏—Ü–∏–∏)
- [Server-Sent Events](#server-sent-events)
- [–ò–≥—Ä–æ–≤–∞—è –ª–æ–≥–∏–∫–∞](#–∏–≥—Ä–æ–≤–∞—è-–ª–æ–≥–∏–∫–∞)

---

## üö∂ –î–≤–∏–∂–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞

### POST `/api/character/multi-move`

–ü–µ—Ä–µ–º–µ—â–∞–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞ –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –Ω–∞ –∑–∞–¥–∞–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤.

#### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞
```json
{
  "direction": "right|left|up|down",
  "steps": 1-10,
  "agentIndex": 0  // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0
}
```

#### –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞
```bash
curl -X POST http://localhost:3000/api/character/multi-move \
  -H "Content-Type: application/json" \
  -d '{
    "direction": "right",
    "steps": 3,
    "agentIndex": 0
  }'
```

#### –ü—Ä–∏–º–µ—Ä —É—Å–ø–µ—à–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
```json
{
  "success": true,
  "steps": [
    {
      "result": true,
      "available_actions": ["use_pc", "use_button"],
      "position": { "x": 3, "y": 2 },
      "level_completed": false
    }
  ],
  "final_position": { "x": 3, "y": 2 },
  "level_completed": false
}
```

#### –ü—Ä–∏–º–µ—Ä –æ—à–∏–±–∫–∏
```json
{
  "success": false,
  "error": "Invalid request. Need direction and steps (1-10)"
}
```

### GET `/api/character/multi-move`

–ü–æ–ª—É—á–∞–µ—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤—Å–µ—Ö –∞–≥–µ–Ω—Ç–æ–≤.

#### –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞
```json
{
  "success": true,
  "data": {
    "agents": [
      { "x": 2, "y": 7 },
      { "x": 16, "y": 3 }
    ],
    "activeAgent": 0,
    "agentCount": 2,
    "position": { "x": 2, "y": 7 },
    "available_actions": ["use_button"]
  }
}
```

---

## üîÑ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–æ–≤

### POST `/api/character/switch-agent`

–ü–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –º–µ–∂–¥—É –∞–≥–µ–Ω—Ç–∞–º–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è —É—Ä–æ–≤–Ω–µ–π —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∞–≥–µ–Ω—Ç–∞–º–∏).

#### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞
```json
{
  "agentIndex": 0  // –ò–Ω–¥–µ–∫—Å –∞–≥–µ–Ω—Ç–∞ (0, 1, ...)
}
```

#### –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞
```bash
curl -X POST http://localhost:3000/api/character/switch-agent \
  -H "Content-Type: application/json" \
  -d '{ "agentIndex": 1 }'
```

#### –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞
```json
{
  "success": true,
  "data": {
    "message": "Switched to agent 1",
    "activeAgent": 1,
    "position": { "x": 16, "y": 3 },
    "agentCount": 2,
    "allAgents": [
      { "x": 2, "y": 7 },
      { "x": 16, "y": 3 }
    ]
  }
}
```

---

## üîò –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–Ω–æ–ø–æ–∫

### POST `/api/character/use-button`

–ê–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –∫–Ω–æ–ø–∫—É (B), –µ—Å–ª–∏ –∞–≥–µ–Ω—Ç —Å—Ç–æ–∏—Ç —Ä—è–¥–æ–º —Å –Ω–µ–π. –û–ø—É—Å–∫–∞–µ—Ç –≤—Å–µ –º–æ—Å—Ç—ã (Z ‚Üí T).

#### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞
–ù–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ–∑–∏—Ü–∏—é –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞.

#### –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞
```bash
curl -X POST http://localhost:3000/api/character/use-button \
  -H "Content-Type: application/json"
```

#### –ü—Ä–∏–º–µ—Ä —É—Å–ø–µ—à–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
```json
{
  "success": true,
  "data": {
    "message": "Button pressed! Bridges activated!",
    "bridgesActivated": true,
    "position": { "x": 6, "y": 3 }
  }
}
```

#### –ü—Ä–∏–º–µ—Ä –æ—à–∏–±–∫–∏
```json
{
  "success": false,
  "error": "No button nearby"
}
```

---

## üíª –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞

### POST `/api/character/use-pc`

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ–º–ø—å—é—Ç–µ—Ä (C) –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è.

#### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞
–ù–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ–∑–∏—Ü–∏—é –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞.

#### –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞
```bash
curl -X POST http://localhost:3000/api/character/use-pc \
  -H "Content-Type: application/json"
```

#### –ü—Ä–∏–º–µ—Ä —É—Å–ø–µ—à–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
```json
{
  "success": true,
  "data": {
    "message": "Computer accessed successfully!",
    "level_completed": true,
    "position": { "x": 1, "y": 3 },
    "victory": true
  }
}
```

#### –ü—Ä–∏–º–µ—Ä –æ—à–∏–±–∫–∏
```json
{
  "success": false,
  "error": "No computer nearby"
}
```

### GET `/api/character/use-pc`

–ü–æ–ª—É—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± endpoint'–µ.

---

## üîÑ –°–±—Ä–æ—Å –ø–æ–∑–∏—Ü–∏–∏

### POST `/api/character/reset`

–°–±—Ä–∞—Å—ã–≤–∞–µ—Ç –≤—Å–µ—Ö –∞–≥–µ–Ω—Ç–æ–≤ –Ω–∞ —Å—Ç–∞—Ä—Ç–æ–≤—ã–µ –ø–æ–∑–∏—Ü–∏–∏ —É—Ä–æ–≤–Ω—è.

#### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞
–ù–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.

#### –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞
```bash
curl -X POST http://localhost:3000/api/character/reset \
  -H "Content-Type: application/json"
```

#### –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞
```json
{
  "success": true,
  "data": {
    "message": "Character reset to starting position",
    "position": { "x": 2, "y": 7 },
    "currentLevel": "Level 3"
  }
}
```

---

## üì° Server-Sent Events

### GET `/api/character/events`

–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Server-Sent Events –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

#### –ü—Ä–∏–º–µ—Ä –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
```javascript
const eventSource = new EventSource('/api/character/events');

eventSource.onmessage = function(event) {
  const data = JSON.parse(event.data);
  console.log('Position update:', data);
};
```

#### –ü—Ä–∏–º–µ—Ä —Å–æ–±—ã—Ç–∏—è
```json
{
  "type": "position_update",
  "agents": [
    { "x": 2, "y": 7 },
    { "x": 16, "y": 3 }
  ],
  "activeAgent": 0,
  "agentCount": 2,
  "position": { "x": 2, "y": 7 },
  "bridgesActivated": false
}
```

---

## üéØ –ò–≥—Ä–æ–≤–∞—è –ª–æ–≥–∏–∫–∞

### –¢–∞–π–ª—ã –∫–∞—Ä—Ç—ã
- **`#`** - Ground (—Å—Ç–µ–Ω–∞) - –Ω–µ–ø—Ä–æ—Ö–æ–¥–∏–º–æ
- **`|`** - Ladder (–ª–µ—Å—Ç–Ω–∏—Ü–∞) - –ø—Ä–æ—Ö–æ–¥–∏–º–æ
- **`C`** - Computer (–∫–æ–º–ø—å—é—Ç–µ—Ä) - —Ü–µ–ª—å —É—Ä–æ–≤–Ω—è
- **`B`** - Button (–∫–Ω–æ–ø–∫–∞) - –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –º–æ—Å—Ç—ã
- **`Z`** - Bridge Up (–ø–æ–¥–Ω—è—Ç—ã–π –º–æ—Å—Ç) - –Ω–µ–ø—Ä–æ—Ö–æ–¥–∏–º–æ
- **`T`** - Bridge Down (–æ–ø—É—â–µ–Ω–Ω—ã–π –º–æ—Å—Ç) - –ø—Ä–æ—Ö–æ–¥–∏–º–æ
- **`‚ñë`** - Empty (–ø—É—Å—Ç–æ—Ç–∞) - –ø—Ä–æ—Ö–æ–¥–∏–º–æ

### –ü—Ä–∞–≤–∏–ª–∞ –¥–≤–∏–∂–µ–Ω–∏—è
1. –ê–≥–µ–Ω—Ç –º–æ–∂–µ—Ç –¥–≤–∏–≥–∞—Ç—å—Å—è –Ω–∞ —Ç–∞–π–ª—ã: `|`, `C`, `T`, `‚ñë`
2. –ê–≥–µ–Ω—Ç **–Ω–µ –º–æ–∂–µ—Ç** –¥–≤–∏–≥–∞—Ç—å—Å—è –Ω–∞ —Ç–∞–π–ª—ã: `#`, `Z` (–µ—Å–ª–∏ –º–æ—Å—Ç—ã –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω—ã)
3. –ü–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏ `B` –≤—Å–µ –º–æ—Å—Ç—ã `Z` —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –ø—Ä–æ—Ö–æ–¥–∏–º—ã–º–∏ `T`

### –ü—Ä–∞–≤–∏–ª–∞ –¥–µ–π—Å—Ç–≤–∏–π
- **–ö–Ω–æ–ø–∫–∞ (B)**: –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å, —Å—Ç–æ—è —Ä—è–¥–æ–º (—Å–æ—Å–µ–¥–Ω—è—è –∫–ª–µ—Ç–∫–∞)
- **–ö–æ–º–ø—å—é—Ç–µ—Ä (C)**: –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å, —Å—Ç–æ—è –Ω–∞ –Ω–µ–º –∏–ª–∏ —Ä—è–¥–æ–º
- **–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–æ–≤**: –¥–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –Ω–∞ —É—Ä–æ–≤–Ω—è—Ö —Å `starting_position_2`

### –ö–æ–¥—ã —Å–æ—Å—Ç–æ—è–Ω–∏—è
- **200** - –£—Å–ø–µ—à–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è
- **400** - –ù–µ–≤–µ—Ä–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞
- **500** - –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

---

## üõ†Ô∏è –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü–æ–ª–Ω—ã–π –∏–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª
```bash
# 1. –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
curl http://localhost:3000/api/character/multi-move

# 2. –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å—Å—è –∫ –∫–Ω–æ–ø–∫–µ
curl -X POST http://localhost:3000/api/character/multi-move \
  -H "Content-Type: application/json" \
  -d '{"direction": "right", "steps": 4}'

# 3. –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É (–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –º–æ—Å—Ç—ã)
curl -X POST http://localhost:3000/api/character/use-button

# 4. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –≤—Ç–æ—Ä–æ–≥–æ –∞–≥–µ–Ω—Ç–∞
curl -X POST http://localhost:3000/api/character/switch-agent \
  -H "Content-Type: application/json" \
  -d '{"agentIndex": 1}'

# 5. –î–æ–π—Ç–∏ –¥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –∏ –∑–∞–≤–µ—Ä—à–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å
curl -X POST http://localhost:3000/api/character/use-pc
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
```javascript
async function moveCharacter(direction, steps) {
  try {
    const response = await fetch('/api/character/multi-move', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ direction, steps })
    });
    
    const result = await response.json();
    
    if (!result.success) {
      console.error('Movement failed:', result.error);
      return;
    }
    
    console.log('Movement successful:', result.final_position);
  } catch (error) {
    console.error('Network error:', error);
  }
}
```

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä**: `npm run dev`
2. **–û—Ç–∫—Ä–æ–π—Ç–µ –∏–≥—Ä—É**: `http://localhost:3000`
3. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ API**: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä—ã –≤—ã—à–µ –∏–ª–∏ Postman

---

*–ò–≥—Ä–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–æ 2 –∞–≥–µ–Ω—Ç–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∏ –≤–∫–ª—é—á–∞–µ—Ç –º–µ—Ö–∞–Ω–∏–∫—É –∫–Ω–æ–ø–æ–∫/–º–æ—Å—Ç–æ–≤ –¥–ª—è –∫–æ–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è –≥–æ–ª–æ–≤–æ–ª–æ–º–æ–∫.* 